<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu" id="hamburgerBtn" title="Toggle Menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <!-- Mobile Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-logo">
            <button class="close-sidebar" id="closeSidebarBtn" title="Close Menu">
                <i class="fas fa-times"></i>
            </button>
            <span><i class="fas fa-book"></i> <span>Dashboard</span></span>
        </div>
        <ul class="sidebar-nav">
            <li><a data-page="overview" class="nav-link active"><i class="fas fa-chart-pie"></i> Overview</a></li>
            <li><a data-page="students" class="nav-link"><i class="fas fa-users"></i> Students</a></li>
            <li class="sidebar-cohorts-divider"><span class="sidebar-section-label">COHORTS</span>
                <ul class="sidebar-section-list">
                    <li><a data-page="cohort0" class="nav-link"><i class="fas fa-map-pin"></i> Cohort 0</a></li>
                    <li><a data-page="cohort1cradis" class="nav-link"><i class="fas fa-map-pin"></i> Cohort 1 - Cradis</a></li>
                    <li><a data-page="cohort1zomra" class="nav-link"><i class="fas fa-map-pin"></i> Cohort 1 - Zomra</a></li>
                    <li><a data-page="cohort2" class="nav-link"><i class="fas fa-map-pin"></i> Cohort 2</a></li>
                    <li><a data-page="cohort3" class="nav-link"><i class="fas fa-map-pin"></i> Cohort 3</a></li>
                </ul>
            </li>
            <li class="sidebar-cohorts-divider"><span class="sidebar-section-label">STATUS</span>
                <ul class="sidebar-section-list">
                    <li><a data-page="waitinglist" class="nav-link"><i class="fas fa-clock"></i> Waiting List</a></li>
                    <li><a data-page="cantreach" class="nav-link"><i class="fas fa-phone-slash"></i> Can't Reach</a></li>
                    <li><a data-page="nextcohort" class="nav-link"><i class="fas fa-arrow-right"></i> Next Cohort</a></li>
                    <li><a data-page="standby" class="nav-link"><i class="fas fa-pause"></i> Standby</a></li>
                </ul>
            </li>
            <li class="sidebar-settings-divider">
                <a data-page="emailtemplates" class="nav-link"><i class="fas fa-envelope"></i> Email Templates</a>
            </li>
            <li class="sidebar-settings-divider">
                <a data-page="settings" class="nav-link"><i class="fas fa-cog"></i> Settings</a>
            </li>
        </ul>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Top Header Bar -->
        <div class="header-bar">
            <div class="header-left">
                <button class="hamburger-menu-header" id="hamburgerBtnHeader" title="Toggle Menu">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="page-title">Overview</h1>
            </div>
            <div class="header-buttons">
                <button onclick="openAddModal()" class="btn-primary"><i class="fas fa-plus"></i> Add Student</button>
            </div>
        </div>

        <!-- Content Wrapper -->
        <div class="content-wrapper">

            <!-- OVERVIEW PAGE -->
            <div id="overview" class="page active">
                <!-- Quick Stats -->
                <div class="stats-grid">
                    <div class="stat-card total">
                        <div class="stat-label">Total Students</div>
                        <div class="stat-value" id="statTotal">0</div>
                        <div class="stat-subtext">All registered students</div>
                    </div>
                    <div class="stat-card current">
                        <div class="stat-label">Cohort 3</div>
                        <div class="stat-value" id="statCohorts">0</div>
                        <div class="stat-subtext">Students in Cohort 3</div>
                    </div>
                    <div class="stat-card pending">
                        <div class="stat-label-wrapper">
                            <div class="stat-label">Pending Payment</div>
                            <button class="eye-toggle" id="pendingToggle" title="Toggle pending payment visibility">
                                <i class="fas fa-eye-slash"></i>
                            </button>
                        </div>
                        <div class="stat-value hidden" id="statPending" data-value="$0">●●●●●</div>
                        <div class="stat-subtext">Awaiting payment</div>
                    </div>
                    <div class="stat-card total">
                        <div class="stat-label">Waiting List</div>
                        <div class="stat-value" id="statWaitingList">0</div>
                        <div class="stat-subtext">Students in waiting list</div>
                    </div>
                    <div class="stat-card total">
                        <div class="stat-label">Next Cohort</div>
                        <div class="stat-value" id="statNextCohort">0</div>
                        <div class="stat-subtext">Students for next cohort</div>
                    </div>
                    <div class="stat-card revenue">
                        <div class="stat-label-wrapper">
                            <div class="stat-label">Total Revenue</div>
                            <button class="eye-toggle" id="revenueToggle" title="Toggle revenue visibility">
                                <i class="fas fa-eye-slash"></i>
                            </button>
                        </div>
                        <div class="stat-value hidden" id="statRevenue" data-value="$0">●●●●●</div>
                        <div class="stat-subtext">From paid students</div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-title">Status Distribution</div>
                        <div class="chart-container">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Revenue Status</div>
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Payment Status - Cohort 2</div>
                        <div class="chart-container">
                            <canvas id="cohort2PaymentChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Payment Status - Standby</div>
                        <div class="chart-container">
                            <canvas id="standbyPaymentChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Payment Status - Cohort 3</div>
                        <div class="chart-container">
                            <canvas id="cohort3PaymentChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Cohort Summary -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-title">Cohort 0 Summary</div>
                        <div class="cohort-stats">
                            <div class="cohort-stat-item">
                                <div class="cohort-stat-label">Students</div>
                                <div class="cohort-stat-value" id="cohort0-count">0</div>
                            </div>
                            <div class="cohort-stat-item cohort-revenue-item">
                                <button class="eye-toggle-small" data-revenue-id="cohort0-revenue" title="Toggle revenue visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="cohort-stat-label">Revenue</div>
                                <div class="cohort-stat-value hidden" id="cohort0-revenue" data-value="$0">●●●</div>
                            </div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Cohort 1 - Cradis Summary</div>
                        <div class="cohort-stats">
                            <div class="cohort-stat-item">
                                <div class="cohort-stat-label">Students</div>
                                <div class="cohort-stat-value" id="cohort1cradis-count">0</div>
                            </div>
                            <div class="cohort-stat-item cohort-revenue-item">
                                <button class="eye-toggle-small" data-revenue-id="cohort1cradis-revenue" title="Toggle revenue visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="cohort-stat-label">Revenue</div>
                                <div class="cohort-stat-value hidden" id="cohort1cradis-revenue" data-value="$0">●●●</div>
                            </div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Cohort 1 - Zomra Summary</div>
                        <div class="cohort-stats">
                            <div class="cohort-stat-item">
                                <div class="cohort-stat-label">Students</div>
                                <div class="cohort-stat-value" id="cohort1zomra-count">0</div>
                            </div>
                            <div class="cohort-stat-item cohort-revenue-item">
                                <button class="eye-toggle-small" data-revenue-id="cohort1zomra-revenue" title="Toggle revenue visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="cohort-stat-label">Revenue</div>
                                <div class="cohort-stat-value hidden" id="cohort1zomra-revenue" data-value="$0">●●●</div>
                            </div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Cohort 2 Summary</div>
                        <div class="cohort-stats">
                            <div class="cohort-stat-item">
                                <div class="cohort-stat-label">Students</div>
                                <div class="cohort-stat-value" id="cohort2-count">0</div>
                            </div>
                            <div class="cohort-stat-item cohort-revenue-item">
                                <button class="eye-toggle-small" data-revenue-id="cohort2-revenue" title="Toggle revenue visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="cohort-stat-label">Revenue</div>
                                <div class="cohort-stat-value hidden" id="cohort2-revenue" data-value="$0">●●●</div>
                            </div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Cohort 3 Summary</div>
                        <div class="cohort-stats">
                            <div class="cohort-stat-item">
                                <div class="cohort-stat-label">Students</div>
                                <div class="cohort-stat-value" id="cohort3-count">0</div>
                            </div>
                            <div class="cohort-stat-item cohort-revenue-item">
                                <button class="eye-toggle-small" data-revenue-id="cohort3-revenue" title="Toggle revenue visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="cohort-stat-label">Revenue</div>
                                <div class="cohort-stat-value hidden" id="cohort3-revenue" data-value="$0">●●●</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Charts Section -->
                <div class="analytics-section">
                    <h2 class="analytics-title"><i class="fas fa-chart-line"></i> Analytics</h2>
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-title">Revenue by Cohort</div>
                            <div class="chart-container">
                                <canvas id="cohortRevenueChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">Students by Cohort</div>
                            <div class="chart-container">
                                <canvas id="cohortStudentsChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-title">Language Distribution</div>
                            <div class="chart-container">
                                <canvas id="languageChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">Student Locations</div>
                            <div class="chart-container">
                                <canvas id="locationsChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STUDENTS PAGE -->
            <div id="students" class="page">
                <div class="controls students-controls">
                    <input type="text" id="searchStudent" placeholder="Search student..." class="search-input">
                    <div class="status-filter-wrapper status-filter-wrapper-inline">
                        <select id="statusFilterStudents" class="status-filter-custom" multiple size="1">
                            <option value="Waiting list">Waiting list</option>
                            <option value="Can't reach">Can't reach</option>
                            <option value="Next Cohort">Next Cohort</option>
                            <option value="Standby">Standby</option>
                            <option value="Cohort 0">Cohort 0</option>
                            <option value="Cohort 1 - Cradis">Cohort 1 - Cradis</option>
                            <option value="Cohort 1 - Zomra">Cohort 1 - Zomra</option>
                            <option value="Cohort 2">Cohort 2</option>
                            <option value="Cohort 3">Cohort 3</option>
                        </select>
                    </div>
                </div>

                <div class="students-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Location</th>
                                <th>Language</th>
                                <th>LinkedIn</th>
                                <th>WhatsApp</th>
                                <th>Notes</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <tr><td colspan="9" class="empty-tbody-cell">Loading students...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- COHORT PAGES -->
            <div id="cohort0" class="page cohort-page"></div>
            <div id="cohort1" class="page cohort-page"></div>
            <div id="cohort1cradis" class="page cohort-page"></div>
            <div id="cohort1zomra" class="page cohort-page"></div>
            <div id="cohort2" class="page cohort-page"></div>
            <div id="cohort3" class="page cohort-page"></div>

            <!-- STATUS PAGES -->
            <div id="waitinglist" class="page status-page"></div>
            <div id="cantreach" class="page status-page"></div>
            <div id="nextcohort" class="page status-page"></div>
            <div id="standby" class="page status-page"></div>
            <div id="graduated" class="page status-page"></div>

            <!-- EMAIL TEMPLATES PAGE -->
            <div id="emailtemplates" class="page">
                <h2 class="page-title-with-button">
                    <span><i class="fas fa-envelope"></i> Email Templates</span>
                    <button onclick="openEmailTemplateModal()" class="btn-primary"><i class="fas fa-plus"></i> Create New Template</button>
                </h2>
                
                <div id="emailTemplatesList" class="students-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Template Name</th>
                                <th>Button Label</th>
                                <th>Subject</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="emailTemplatesBody">
                            <tr><td colspan="4" class="empty-templates-cell">No templates yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SETTINGS PAGE -->
            <div id="settings" class="page">
                <h2 class="settings-title"><i class="fas fa-cog"></i> Settings</h2>
                
                <div class="students-table">
                    <table>
                        <tbody>
                            <tr class="settings-table-row">
                                <td class="settings-table-label"><i class="fas fa-chart-bar"></i> Sync to Google Sheets</td>
                                <td class="settings-table-action">
                                    <button onclick="syncToGoogleSheets()" class="btn-primary"><i class="fas fa-cloud"></i> Update Sheet Now</button>
                                    <a href="https://docs.google.com/spreadsheets/d/1nZJJGgwRgv8KrKp3EY_5X94iTPzyNxIw_hCq28yuw-k/edit?usp=sharing" target="_blank" class="btn-primary" style="text-decoration: none; margin-left: 8px; display: inline-flex; align-items: center;"><i class="fas fa-external-link-alt"></i> Open Sheet</a>
                                </td>
                            </tr>
                            <tr class="settings-table-row">
                                <td class="settings-table-label">Export Student Data</td>
                                <td class="settings-table-action">
                                    <button onclick="exportData()" class="btn-primary"><i class="fas fa-download"></i> Export as JSON</button>
                                </td>
                            </tr>
                            <tr class="settings-table-row">
                                <td class="settings-table-label">Import Student Data</td>
                                <td class="settings-table-action">
                                    <button onclick="importData()" class="btn-primary"><i class="fas fa-upload"></i> Import from JSON</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="settings-table-label-error">Clear All Data</td>
                                <td class="settings-table-action">
                                    <button onclick="clearAllData()" class="btn-small btn-danger"><i class="fas fa-trash"></i> Clear All</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="settings-tip"><i class="fas fa-lightbulb"></i> Tip: Click "Update Sheet Now" to push all dashboard data to your Google Sheet. Use Export to backup your data, and Import to restore it.</p>
                <div id="syncStatus"></div>
            </div>

        </div>
    </div>

    <input type="file" id="importFile" accept=".json" class="import-file-input" onchange="handleImport(event)">

    <!-- Add/Edit Student Modal -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeStudentModal()"><i class="fas fa-times"></i></span>
            <div class="modal-header"><i class="fas fa-user-plus modal-header-icon"></i> <span id="modalTitle">Add New Student</span></div>
            
            <form id="studentForm" onsubmit="saveStudent(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">Name *</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="linkedin">LinkedIn Profile</label>
                        <input type="url" id="linkedin" placeholder="https://linkedin.com/in/username">
                    </div>
                    <div class="form-group">
                        <label for="whatsapp">WhatsApp Number</label>
                        <input type="tel" id="whatsapp">
                    </div>
                    <div class="form-group">
                        <label for="figmaEmail">Figma Email</label>
                        <input type="email" id="figmaEmail" placeholder="student@example.com">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="location">Location (Country)</label>
                        <input type="text" id="location">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="language">Language</label>
                        <select id="language">
                            <option value="">Select Language</option>
                            <option value="English">English</option>
                            <option value="Arabic">Arabic</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select id="status" onchange="toggleChecklistSection()">
                            <option value="">Select Status</option>
                            <option value="Waiting list">Waiting list</option>
                            <option value="Can't reach">Can't reach</option>
                            <option value="Next Cohort">Next Cohort</option>
                            <option value="Standby">Standby</option>
                            <option value="Cohort 0">Cohort 0</option>
                            <option value="Cohort 1 - Cradis">Cohort 1 - Cradis</option>
                            <option value="Cohort 1 - Zomra">Cohort 1 - Zomra</option>
                            <option value="Cohort 2">Cohort 2</option>
                            <option value="Cohort 3">Cohort 3</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="note">Notes</label>
                        <input type="text" id="note" placeholder="Add any notes about the student">
                    </div>
                    <div class="form-group">
                        <label for="paymentMethod">Payment Method</label>
                        <select id="paymentMethod">
                            <option value="">Select Payment Method</option>
                            <option value="Stripe">Stripe</option>
                            <option value="Instapay">Instapay</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="totalAmount">Total Amount</label>
                        <input type="number" id="totalAmount" step="0.01" onchange="calculateRemaining()" oninput="calculateRemaining()">
                    </div>
                    <div class="form-group">
                        <label for="paidAmount">Paid Amount</label>
                        <input type="number" id="paidAmount" step="0.01" value="0" onchange="calculateRemaining()" oninput="calculateRemaining()">
                    </div>
                    <div class="form-group">
                        <label for="remaining">Remaining</label>
                        <input type="number" id="remaining" step="0.01" value="0" readonly>
                    </div>
                </div>

                <!-- Checklist Section - Only for Current Cohort -->
                <div id="checklistSection" class="checklist-section">
                    <h3>Onboarding Checklist</h3>
                    <div class="checklist-item">
                        <input type="checkbox" id="addedCommunity">
                        <label for="addedCommunity">Added to community group</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="sharedAgreement">
                        <label for="sharedAgreement">Shared course agreement</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="signedAgreement">
                        <label for="signedAgreement">Signed course agreement</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="sharedDrive">
                        <label for="sharedDrive">Shared Google Drive folder</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="createdFigma">
                        <label for="createdFigma">Created Figma account</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="sharedMasterFigma">
                        <label for="sharedMasterFigma">Shared Master Figma file</label>
                    </div>
                    
                    <div class="figma-status-simple">
                        <label class="figma-status-label-main">Figma Submission Status</label>
                        <div class="figma-status-section">
                            <div class="figma-status-item">
                                <input type="radio" id="figmaNotStarted" name="figmaStatus" value="Not started" checked>
                                <label for="figmaNotStarted" class="figma-status-radio">Not started</label>
                            </div>
                            <div class="figma-status-item">
                                <input type="radio" id="figmaSubmitted" name="figmaStatus" value="Submitted">
                                <label for="figmaSubmitted" class="figma-status-radio">Submitted</label>
                            </div>
                            <div class="figma-status-item">
                                <input type="radio" id="figmaUnderReview" name="figmaStatus" value="Under review">
                                <label for="figmaUnderReview" class="figma-status-radio">Under review</label>
                            </div>
                            <div class="figma-status-item">
                                <input type="radio" id="figmaApproved" name="figmaStatus" value="Approved">
                                <label for="figmaApproved" class="figma-status-radio">Approved</label>
                            </div>
                        </div>
                    </div>

                    <div class="post-course-actions post-course-actions-margin">
                        <h4><i class="fas fa-flag-checkered"></i> Post-Course Actions</h4>
                        <div class="checklist-item">
                            <input type="checkbox" id="sharedFeedbackForm">
                            <label for="sharedFeedbackForm">Shared feedback form</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="submittedCourseFeedback">
                            <label for="submittedCourseFeedback">Submitted course feedback</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="issuedCertificate">
                            <label for="issuedCertificate">Issued the certificate</label>
                        </div>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button type="button" onclick="closeStudentModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Save Student</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Email Template Modal -->
    <div id="emailTemplateModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEmailTemplateModal()"><i class="fas fa-times"></i></span>
            <div class="modal-header"><i class="fas fa-envelope modal-header-icon"></i> <span id="emailModalTitle">Create Email Template</span></div>
            
            <form id="emailTemplateForm" onsubmit="saveEmailTemplate(event)">
                <div class="form-group">
                    <label for="templateName">Template Name *</label>
                    <input type="text" id="templateName" required placeholder="e.g., Community Invitation">
                </div>

                <div class="form-group">
                    <label for="buttonLabel">Button Label *</label>
                    <input type="text" id="buttonLabel" required placeholder="e.g., Send Invitation">
                </div>

                <div class="form-group">
                    <label for="emailSubject">Email Subject *</label>
                    <input type="text" id="emailSubject" required placeholder="e.g., Welcome to Design Tokens!">
                </div>

                <div class="form-group">
                    <label for="emailBody">Email Body *</label>
                    <textarea id="emailBody" required class="email-body-textarea"></textarea>
                    <small class="email-body-help"><i class="fas fa-info-circle"></i> <strong>Available dynamic tags:</strong> {name}, {email}, {cohort}, {status}, {location}, {language}, {linkedin}, {whatsapp}, {figmaEmail}, {paymentMethod}, {totalAmount}, {paidAmount}, {remaining}, {note}</small>
                </div>

                <div class="modal-buttons">
                    <button type="button" onclick="closeEmailTemplateModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Save Template</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bulk Email Modal -->
    <div id="bulkEmailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBulkEmailModal()"><i class="fas fa-times"></i></span>
            <div class="modal-header"><i class="fas fa-envelope modal-header-icon"></i> Send Bulk Email</div>
            
            <form id="bulkEmailForm" onsubmit="sendBulkEmail(event)">
                <div class="form-group">
                    <label for="bulkTemplate">Select Template *</label>
                    <select id="bulkTemplate" required onchange="updateBulkRecipientCount()">
                        <option value="">-- Choose a template --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label><strong>Select Group *</strong></label>
                    <div id="bulkGroupOptions" class="bulk-group-options">
                        <!-- Radio buttons will be populated here -->
                    </div>
                </div>

                <div class="bulk-recipient-preview">
                    <div class="preview-card">
                        <i class="fas fa-users"></i>
                        <div>
                            <div class="preview-label">Recipients</div>
                            <div class="preview-count" id="bulkRecipientCount">0</div>
                        </div>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button type="button" onclick="closeBulkEmailModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary"><i class="fas fa-paper-plane"></i> Send to Group</button>
                </div>
            </form>

            <div id="bulkEmailStatus" class="bulk-email-status"></div>
        </div>
    </div>

    <!-- Student Contact Modal -->
    <div id="studentContactModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeStudentContactModal()"><i class="fas fa-times"></i></span>
            <div class="modal-header"><i class="fas fa-paper-plane modal-header-icon"></i> Contact Student</div>
            
            <div id="studentContactInfo" class="contact-info-background">
                <div id="allContactDetails" class="contact-info-grid"></div>
                <div id="checklistContactInfo"></div>
            </div>

            <h3 class="contact-modal-title">Send Email</h3>
            
            <div id="emailLoadingIndicator" class="email-loading-indicator">
                <div class="loading-spinner"></div>
                <span class="loading-text">Sending email...</span>
            </div>
            
            <div id="studentEmailTemplates" class="contact-email-templates"></div>

            <div class="modal-buttons contact-modal-buttons">
                <button type="button" onclick="closeStudentContactModal()" class="btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
